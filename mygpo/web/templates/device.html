{% extends "base.html" %}
{% load i18n %}
{% load humanize %}
{% load devices %}
{% load podcasts %}

{% block content %}
  <h1>{{ device.name|striptags }}</h1>

  {% if device.deleted %}<div class="info">{% trans "This device was deleted." %}</div>{% endif %}

  <h2>{% trans "Podcasts" %}</h2>

  {% if not subscriptions|length_is:"0" %}
   <p>{% trans "You have subscribed the following podcasts on this device" %}
   <table class="list">
    <tr>
     <th></th>
     <th>{% trans "Title" %}</th>
     <th>{% trans "Since" %}</th>
     <th>{% trans "Unsubscribe" %}</th>
    </tr>

    {% for subscription in subscriptions %}
     <tr>
      <td>{{ subscription.podcast|podcast_logo }}</td>
      <td><a href="/podcast/{{subscription.podcast.id}}">{{ subscription.podcast|striptags }}</a></td>
      <td><abbr title="{{subscription.subscribed_since}}">{{subscription.subscribed_since|naturalday}}</abbr></td>
      <td><a href="/podcast/{{subscription.podcast.id}}/unsubscribe/{{ device.id }}?return_to=/device/{{ device.id }}"><img src="/media/unsubscribe.png" /></a></td>
     </tr>
    {% endfor %}
   </table>
  {% else %}
   <p>{% trans "You don't have any podcasts subscribed on this device. Go ahead and upload some." %}</p>
  {% endif %}

  {% if not device.deleted %}

  <h2>{% trans "Synchronize" %}</h2>
  <p>{% blocktrans %}If you synchronize devices, they will always have the same subscriptions. A podcast that is subscribed on one device, will automatically be added to all synchronized devices.{% endblocktrans %}</p>

  {% if synced_with|length_is:"0" %}

   <p>{% blocktrans with device.name|striptags as devicename %}{{ devicename }} is currently not synchronized with other devices.{% endblocktrans %}</p>

  {% else %}

   <p>{% blocktrans with device.name|striptags as devicename and synced_with|device_list as synclist %}{{ devicename }} is currently synchronized with {{ synclist }}.{% endblocktrans %}</p>
   <a href="/device/{{ device.id }}/unsync">{% blocktrans with device.name|striptags as devicename %}Stop synchronisation for {{ devicename }} {% endblocktrans %}</a>
  
  {% endif %}

  {% if has_sync_targets %}
   <form action="/device/{{ device.id }}/sync" method="POST">
    {{ sync_form.as_p }}
    <input type="submit" value="{% trans "OK" %}" />
   </form>
  {% endif %}

  <h2>{% trans "Edit" %}</h2>
  {% if success %}
   <div class="success">{% trans "Your settings have been saved." %}</div>
  {% endif %}

  <form action="" method="POST">
   {{ device_form.as_p }}
   <input type="submit" value="Save" />
  </form>

  <h2>{% trans "Delete" %}</h2>
  <form action="/device/{{ device.id }}/delete" method="POST">
   <input type="submit" value="{% trans "Delete this device" %}" />
  </form>
  <br />
  {% endif %}
  <div class="info">The <strong>UID</strong> connects your physical device with this page, so you should enter the same text on your device and here.</div>

{% endblock %}


{% extends "base.html" %}

{% load i18n %}
{% load podcasts %}
{% load charts %}
{% load math %}

{% load menu %}
{% block mainmenu %}{{ "/toplist/"|main_menu }}{% endblock %}
{% block sectionmenu %}{{ "/toplist/"|section_menu }}{% endblock %}

{% block title %}{% trans "Toplist" %}{% endblock %}

{% block content %}
  <h1>{% trans "Toplist" %}</h1>

  <p>{% blocktrans with entries|length as count %}These are the {{ count }} most subscribed podcasts.{% endblocktrans %}</p>

  <table class="list">
   <tr>
    <th></th>
    <th></th>
    <th></th>
    <th>{% trans "Podcast" %}</th>
    <th>{% trans "Subscribers" %}</th>
   </tr>
  {% for entry in entries %}
   <tr>
    <td class="numeric">{{ forloop.counter }}</td>
    <td class="oldposition">
     {% if entry.oldplace %}
      {% if entry.oldplace|subtract:forloop.counter %}
       {{ entry.oldplace|subtract:forloop.counter|format_diff }}
      {% endif %}
      {% else %}
      <img src="/media/charts-new.png" alt="new">
     {% endif %}
    </td>
    <td>{{ entry.podcast|podcast_logo }}</td>
    <td><a href="/podcast/{{ entry.podcast.id }}">{{ entry.podcast|striptags }}</a></td>
    <td>{{ entry.subscriptions|vertical_bar:max_subscribers }}</td>
   </tr>
  {% endfor %}
  </table>

  <div class="info"><strong>Get the toplist from your Client</strong>! Access <a href="/toplist/30.opml">http://{{ url }}/toplist/30.opml</a> for the Top-30.</div>
{% endblock %}

